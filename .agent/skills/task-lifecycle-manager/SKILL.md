---
name: task-lifecycle-manager
description: æ ‡å‡†åŒ–ä»»åŠ¡ç”Ÿå‘½å‘¨æœŸç®¡ç†ï¼Œæ¶µç›–ä»»åŠ¡åˆ›å»º(Template)ã€è¿›åº¦åŒæ­¥(Sync)ã€æ–‡æ¡£è§„èŒƒ(Spec/Report)åŠé—­ç¯å½’æ¡£(Finalize)ã€‚ç¡®ä¿ PSB åè®®çš„æ–‡æ¡£å®Œæ•´æ€§ä¸çŠ¶æ€çœŸå®æ€§ã€‚
---

# Task Lifecycle Manager (TLM)

æ­¤æŠ€èƒ½å®šä¹‰äº† TG ONE é¡¹ç›®ä¸­ä»»åŠ¡ç®¡ç†çš„**å”¯ä¸€æ ‡å‡†æµç¨‹**ã€‚
ä½œä¸º AI åŠ©æ‰‹ï¼Œåœ¨æ‰§è¡Œä»»ä½•å¤æ‚ç¼–ç ä»»åŠ¡ï¼ˆéœ€å»ºç«‹ `Workstream` çš„ä»»åŠ¡ï¼‰æ—¶ï¼Œå¿…é¡»ä¸¥æ ¼éµå®ˆæ­¤è§„èŒƒã€‚

## 1. æ ¸å¿ƒç†å¿µ

> **æ–‡æ¡£å³çŠ¶æ€ (Documentation is State)**
> ä»£ç æ˜¯é€»è¾‘çš„è½½ä½“ï¼Œè€Œæ–‡æ¡£æ˜¯å·¥ç¨‹è¿›åº¦çš„å”¯ä¸€çœŸç†æ¥æº (Source of Truth)ã€‚
> æ°¸è¿œä¸è¦è®© `todo.md` çš„çŠ¶æ€è½åäºä»£ç å®ç°ã€‚

## 2. æ–‡æ¡£è§„èŒƒæ ‡å‡† (Standards)

æ‰€æœ‰æ–°åˆ›å»ºçš„ä»»åŠ¡æ–‡ä»¶å¤¹ (`docs/Workstream_{Domain}/{Date}_{TaskName}`) å¿…é¡»åŒ…å«ä»¥ä¸‹æ ¸å¿ƒæ–‡ä»¶ï¼š

### 2.1 `todo.md` (ä»»åŠ¡æ¸…å•)
*   **å®šä½**: ä»»åŠ¡çš„é©¾é©¶èˆ±ï¼Œè®°å½•"è¦åšä»€ä¹ˆ"å’Œ"åšåˆ°äº†å“ªé‡Œ"ã€‚
*   **æ ¸å¿ƒè¦ç´ **:
    *   **Context**: 1-2 å¥è¯æè¿°ä»»åŠ¡èƒŒæ™¯ã€‚
    *   **Strategy**: ç®€è¿°æ ¸å¿ƒæŠ€æœ¯è·¯å¾„ï¼ˆå¦‚ï¼šFacade æ¨¡å¼é‡æ„ï¼ŒAIMD ç®—æ³•å®ç°ï¼‰ã€‚
    *   **Phased Checklist**: å¿…é¡»æŒ‰ Phase 1, Phase 2... åˆ†é˜¶æ®µåˆ—å‡ºè¯¦ç»† Checkboxã€‚
*   **çŠ¶æ€è§„åˆ™**:
    *   `[ ]`: å¾…å¼€å§‹ã€‚
    *   `[x]`: å·²å®Œæˆï¼ˆå¿…é¡»ç»ä»£ç éªŒè¯ï¼‰ã€‚
    *   `[~]`: éƒ¨åˆ†å®Œæˆ/æŒ‚èµ·ï¼ˆéœ€å¤‡æ³¨åŸå› ï¼‰ã€‚

### 2.2 `spec.md` (æŠ€æœ¯æ–¹æ¡ˆ)
*   **å®šä½**: å®æ–½å‰çš„è“å›¾ï¼Œé˜²æ­¢èµ°æ­ªã€‚
*   **è§¦å‘æ¡ä»¶**: æ¶‰åŠ DB å˜æ›´ã€API æ¥å£å˜æ›´ã€æ ¸å¿ƒæ¶æ„è°ƒæ•´æ—¶**å¿…é¡»**ç¼–å†™ã€‚
*   **æ ¸å¿ƒè¦ç´ **:
    *   **Database Changes**: SQL DDL æˆ– SQLAlchemy æ¨¡å‹å®šä¹‰ã€‚
    *   **API Design**: Endpoint, Request/Response ç¤ºä¾‹ã€‚
    *   **Class/Component Design**: æ ¸å¿ƒç±»å›¾æˆ–æ¥å£å®šä¹‰ã€‚

### 2.3 `report.md` (äº¤ä»˜æŠ¥å‘Š)
*   **å®šä½**: ä»»åŠ¡ç»“æŸçš„éªŒæ”¶å•ï¼Œè¯æ˜"æˆ‘åšå®Œäº†"ä¸”"è´¨é‡è¾¾æ ‡"ã€‚
*   **æ ¸å¿ƒè¦ç´ **:
    *   **Summary**: ä¸€å¥è¯æ¦‚æ‹¬äº§å‡ºã€‚
    *   **Architecture Refactor**: å®é™…å‘ç”Ÿçš„æ¶æ„å˜æ›´ã€‚
    *   **Verification**: æµ‹è¯•ç»“æœï¼ˆå•å…ƒæµ‹è¯•é€šè¿‡ç‡ã€åŠŸèƒ½éªŒè¯æˆªå›¾/æ—¥å¿—ï¼‰ã€‚
    *   **Manual**: å…³é”®é…ç½®é¡¹æˆ–ç”¨æˆ·æ“ä½œæŒ‡å—ã€‚

### 2.4 `process.md` (å…¨å±€æ€»çº¿)
*   **å®šä½**: é¡¹ç›®ä¸Šå¸è§†è§’ï¼Œä½äº `docs/process.md`ã€‚
*   **ç»´æŠ¤è§„åˆ™**:
    *   ä»»åŠ¡å¯åŠ¨æ—¶ï¼šåœ¨ `è¿›è¡Œä¸­ä»»åŠ¡` æ·»åŠ æ¡ç›®ã€‚
    *   ä»»åŠ¡å®Œæˆæ—¶ï¼šç§»è‡³ `å·²å®Œæˆä»»åŠ¡` è¡¨æ ¼ï¼ŒçŠ¶æ€è®°ä¸º `100%`ï¼Œé™„ä¸Šæ–‡ä»¶å¤¹é“¾æ¥ã€‚

---

## 3. æ ‡å‡†ä½œä¸šæµç¨‹ (SOP)

### Stage 1: Initialization (å¯åŠ¨)
1.  **å®šä½é¢†åŸŸ**: ç¡®å®š `Workstream_{Domain}`ã€‚
2.  **åˆ›å»ºç›®å½•**: `mkdir {YYYYMMDD}_{TaskName}_{Phase}`ã€‚
3.  **ç”Ÿæˆæ¨¡ç‰ˆ**:
    *   åˆ›å»º `todo.md` å¹¶å¡«å…¥åˆå§‹è§„åˆ’ã€‚
    *   å¦‚æœä»»åŠ¡å¤æ‚ï¼Œåˆ›å»º `spec.md`ã€‚
    *   æ›´æ–° `docs/process.md`ï¼Œæ³¨å†Œæ–°ä»»åŠ¡ã€‚

### Stage 2: Synchronization (åŒæ­¥)
> **ä½•æ—¶æ‰§è¡Œ**: æ¯æ¬¡å¯¹è¯ç»“æŸå‰ï¼Œæˆ–ç”¨æˆ·è¯¢é—®"è¿›åº¦å¦‚ä½•"æ—¶ã€‚

1.  **ä»£ç å®¡è®¡ (Code Audit)**:
    *   æ£€æŸ¥ä»£ç æ˜¯å¦å·²å®ç° `todo.md` ä¸­çš„ Checkbox é¡¹ã€‚
    *   *Tip*: ä½¿ç”¨ `grep` æœç´¢å…³é”®å‡½æ•°åã€ç±»åã€é…ç½®é¡¹æ¥éªŒè¯å­˜åœ¨æ€§ã€‚
2.  **è‡ªåŠ¨åŒ–éªŒè¯ (Automated Verification)** â­ NEW - MANDATORY:
    *   è¿è¡Œ `task-syncer` æŠ€èƒ½è¿›è¡Œæ–‡ä»¶å­˜åœ¨æ€§éªŒè¯:
    ```bash
    python .agent/skills/task-syncer/scripts/check_status.py "docs/current/todo.md"
    ```
    *   æ ¹æ®è¾“å‡ºç»“æœä¿®æ­£ `todo.md` çš„å‹¾é€‰çŠ¶æ€ã€‚
3.  **çŠ¶æ€æ ¡å‡† (State Alignment)**:
    *   å‘ç°ä»£ç å·²å®ç°ä½†æ–‡æ¡£æœªå‹¾é€‰ -> **ç«‹å³å‹¾é€‰**ã€‚
    *   å‘ç°ä»£ç é€»è¾‘å˜æ›´ -> **æ›´æ–° todo æè¿°**ã€‚
    *   å‘ç°å·²åºŸå¼ƒçš„è®¡åˆ’ -> æ ‡è®°ä¸º `[Skipped]` æˆ–åˆ é™¤ã€‚

### Stage 3: Finalization (é—­ç¯)
> **ä½•æ—¶æ‰§è¡Œ**: æ‰€æœ‰æ ¸å¿ƒ Checkbox (`P0/P1`) å‡ä¸º `[x]` æ—¶ã€‚

1.  **ç”ŸæˆæŠ¥å‘Š**: ç¼–å†™ `report.md`ã€‚
2.  **å…¨å±€æ›´æ–°**:
    *   å°† `docs/process.md` ä¸­çš„æ¡ç›®çŠ¶æ€æ”¹ä¸º `100%`ã€‚
    *   å¡«å†™ `å®Œæˆæ—¥æœŸ`ã€‚
3.  **æ¸…ç†ç°åœº**:
    *   åˆ é™¤æ ¹ç›®å½•ä¸‹çš„ä¸´æ—¶æ–‡ä»¶ (`temp_*.py`, `debug.log`)ã€‚
    *   è¿è¡Œ `tree` å‘½ä»¤æ›´æ–° `docs/tree.md` (æˆ–ä½¿ç”¨ `docs-maintenance` æŠ€èƒ½)ã€‚

### Stage 4: Evolution Assessment (è¿›åŒ–è¯„ä¼°) â­ NEW - CLOSED LOOP
> **ä½•æ—¶æ‰§è¡Œ**: æŠ¥å‘Šæäº¤åï¼Œå½’æ¡£å‰ã€‚

1.  **æŠ€èƒ½å›é¡¾ (Skill Review)**:
    *   æœ¬ä»»åŠ¡æ˜¯å¦è°ƒç”¨äº†ç°æœ‰ Skillï¼Ÿ
    *   è‹¥è°ƒç”¨å¤±è´¥å¹¶è½¬ä¸ºæ‰‹åŠ¨ï¼Œ**å¿…é¡»**è°ƒç”¨ `skill-evolution` ä¿®å¤è¯¥ Skillã€‚
2.  **æ–°æŠ€èƒ½æŒ–æ˜ (Skill Mining)**:
    *   æœ¬ä»»åŠ¡æ˜¯å¦è§£å†³äº†é‡å¤æ€§é—®é¢˜ï¼Ÿ(å†å²ç±»ä¼¼ä»»åŠ¡ > 1)
    *   è‹¥æ˜¯ï¼Œ**å¿…é¡»**è°ƒç”¨ `skill-evolution` å°†æœ¬ä»»åŠ¡äº§å‡º (Scripts/SOP) è½¬åŒ–ä¸ºæ–° Skillã€‚


---

## 4. æŠ€èƒ½æŒ‡ä»¤ (Actions)

### `@check_status` (çŠ¶æ€æ£€æŸ¥)
å½“ç”¨æˆ·è¦æ±‚"åŒæ­¥çŠ¶æ€"æˆ–"æ£€æŸ¥è¿›åº¦"æ—¶ï¼š
1.  è¯»å–å½“å‰ä»»åŠ¡ç›®å½•ä¸‹çš„ `todo.md`ã€‚
2.  è¯»å– `src/` æˆ– `handlers/` ä¸‹çš„ç›¸å…³ä»£ç æ–‡ä»¶ã€‚
3.  å¯¹æ¯”å·®å¼‚ï¼Œå¹¶æ‰§è¡Œ `multi_replace_file_content` æ›´æ–° `todo.md`ã€‚
4.  å¦‚æœä»»åŠ¡çœ‹ä¼¼å·²å®Œæˆï¼ˆå…³é”®åŠŸèƒ½å‡å­˜åœ¨ï¼‰ï¼Œæ£€æŸ¥ `report.md` æ˜¯å¦ç”Ÿæˆã€‚

### `@finalize_task` (ä»»åŠ¡ç»“é¡¹)
1.  ç¡®è®¤ `todo.md` å…¨ç»¿ã€‚
2.  åˆ›å»º/æ›´æ–° `report.md`ã€‚
3.  æ›´æ–° `docs/process.md` è¡¨æ ¼ã€‚
4.  æé†’ç”¨æˆ·ï¼š"ä»»åŠ¡å·²é—­ç¯ï¼Œæ–‡æ¡£å·²å¯¹é½ã€‚"

### `@create_spec` (åˆ›å»ºæ–¹æ¡ˆ)
1.  åœ¨å½“å‰ä»»åŠ¡ç›®å½•ä¸‹åˆ›å»º `spec.md`ã€‚
2.  å¡«å…¥æ¨¡ç‰ˆï¼š`## èƒŒæ™¯`, `## DB Schema`, `## API Design`, `## Implementation Steps`ã€‚

---

## 5. æ¨¡ç‰ˆç¤ºä¾‹ (Templates)

### todo.md Template
```markdown
# ä»»åŠ¡åç§° (Task Name)

## èƒŒæ™¯ (Context)
ç®€è¿°ä»»åŠ¡ç›®æ ‡...

## å¾…åŠæ¸…å• (Checklist)

### Phase 1: æ ¸å¿ƒå®ç°
- [ ] å®šä¹‰æ•°æ®æ¨¡å‹ (Schema)
- [ ] å®ç° Service å±‚é€»è¾‘
- [ ] ç¼–å†™å•å…ƒæµ‹è¯•

### Phase 2: UI é›†æˆ
- [ ] æ›´æ–° Web è·¯ç”±
- [ ] å®ç°å‰ç«¯é¡µé¢
```

### process.md Entry Template
```markdown
| {YYYYMMDD}_{Task} | {Task Description} | {Start Date} | {End Date} | 100% | [ğŸ“‚ æŸ¥çœ‹](./Workstream_{Domain}/{Folder}/) |
```
