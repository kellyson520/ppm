---
name: local-ci
description: æœ¬åœ° CI æ‰§è¡Œå™¨ã€‚åœ¨æäº¤ä»£ç å‰å¼ºåˆ¶è¿è¡Œæ¶æ„æ£€æŸ¥ã€é£æ ¼æ£€æŸ¥å’Œé’ˆå¯¹æ€§å•å…ƒæµ‹è¯•ï¼ˆé€‚é… Flutter/Dart åŠåŸç”Ÿå±‚ï¼‰ï¼Œç¡®ä¿æœ¬åœ°è´¨é‡é—¨ç¦é€šè¿‡ã€‚
version: 2.0
---

# ğŸ¯ Triggers
- å½“ç”¨æˆ·å‡†å¤‡æäº¤ä»£ç  (`git commit` / `push`) æ—¶ã€‚
- å½“ç”¨æˆ·è¾“å…¥ `/ship` æˆ–è¦æ±‚ "CI" æ—¶ã€‚
- å½“ç”¨æˆ·è¯¢é—® "ä»£ç æ˜¯å¦ç¬¦åˆè§„èŒƒ" æ—¶ã€‚

# ğŸ§  Role & Context
ä½ æ˜¯ä¸€å **è´¨é‡å«å£« (Gatekeeper)**ã€‚ä½ çš„èŒè´£æ˜¯æ‹¦æˆªå¹¶å°†ä½è´¨é‡ä»£ç ï¼ˆåˆ†æé”™è¯¯ã€æ ¼å¼å·®ã€æœªé€šè¿‡æµ‹è¯•ï¼‰æ‹¦æˆªåœ¨æœ¬åœ°ã€‚ç”±äºæœ¬é¡¹ç›®ä¸º Flutter é¡¹ç›®ï¼Œä½ å¿…é¡»ä¼˜å…ˆæ‰§è¡Œ Flutter åŸç”Ÿè´¨é‡æ£€æŸ¥å·¥å…·ã€‚

# âœ… Standards & Rules

## 1. Flutter Local CI æµç¨‹ (Standard)
1.  **ä¿®å¤å»ºè®®**: `dart fix --apply` (ä¼˜å…ˆè‡ªåŠ¨ä¿®å¤ lint é—®é¢˜)ã€‚
2.  **ä»£ç é£æ ¼æ ¼å¼åŒ–**: `dart format .`
3.  **å¤šè¯­è¨€åŒæ­¥**: è‹¥ä¿®æ”¹äº† `.arb` æ–‡ä»¶ï¼Œè¿è¡Œ `flutter gen-l10n`ã€‚
4.  **é™æ€åˆ†æ**: `flutter analyze` (ç¦æ­¢ä»»ä½• errorï¼Œwarning éœ€è¯„ä¼°)ã€‚
5.  **ç”Ÿæˆä»£ç æ ¡éªŒ**: 
    - è‹¥ä¿®æ”¹äº†æ¨¡å‹æˆ– BLoCï¼š`dart run build_runner build --delete-conflicting-outputs`ã€‚
6.  **å•å…ƒæµ‹è¯• (Test)**: 
    - é’ˆå¯¹æ€§æµ‹è¯•: `flutter test test/path/to/test.dart`ã€‚
    - å…¨é‡æµ‹è¯•: `flutter test` (å»ºè®®èšç„¦ä¿®æ”¹æ¨¡å—)ã€‚

## 2. åŸç”Ÿå±‚æ£€æŸ¥ (Native Layer)
- è‹¥ä¿®æ”¹äº† `android/` ç›®å½•: `./gradlew lintDebug`ã€‚
- è‹¥ä¿®æ”¹äº† `ios/` ç›®å½•: æ‰§è¡Œ `pod lib lint` (è‹¥é€‚ç”¨)ã€‚

## 3. å¤±è´¥å¤„ç½® (Failure Handling)
- ä»»ä½•æ­¥éª¤å¤±è´¥ï¼Œç«‹å³ç»ˆæ­¢ã€‚
- ç¦æ­¢æ¨é€åˆ°äº‘ç«¯ã€‚
- å¿…é¡»å®šä½åˆ°å…·ä½“çš„åˆ†æé”™è¯¯æˆ–æµ‹è¯•å¤±è´¥ç‚¹ã€‚

# ğŸš€ Workflow
1.  **Analyze**: ç¡®è®¤å½“å‰å·¥ä½œåŒºæ˜¯å¦ä¸º Flutterã€‚
2.  **Execute Flutter Lint**: `flutter analyze`ã€‚
3.  **Execute Build Runner**: è‹¥æ¶‰åŠ Freezed/JsonSerializableï¼Œè¿è¡Œ `dart run build_runner build`ã€‚
4.  **Execute Tests**: è¿è¡Œå—å½±å“æ¨¡å—çš„ `flutter test`ã€‚
5.  **Result**: å…¨éƒ¨ âœ… é€šè¿‡åï¼Œæç¤ºç”¨æˆ·å¯è¿›è¡Œ `git commit`ã€‚

# ğŸ’¡ Examples
**User:** "å‡†å¤‡æäº¤äºŒç»´ç æ‰«æåŠŸèƒ½çš„æ”¹åŠ¨ã€‚"
**Agent:** 
"æ”¶åˆ°ã€‚æ­£åœ¨æ‰§è¡Œ Flutter æœ¬åœ° CI é¢„æ£€...
1. è¿è¡Œ `flutter analyze`... [æˆåŠŸ]
2. è¿è¡Œç›¸å…³æµ‹è¯• `test/ui/screens/qr_scanner_test.dart`... [æˆåŠŸ]
CI é¢„æ£€é€šè¿‡ï¼æ‚¨å¯ä»¥æ”¾å¿ƒæäº¤ã€‚"
